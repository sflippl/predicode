%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}
\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}


% Jupyter Notebook code cell colors
\definecolor{nbsphinxin}{HTML}{307FC1}
\definecolor{nbsphinxout}{HTML}{BF5B3D}
\definecolor{nbsphinx-code-bg}{HTML}{F5F5F5}
\definecolor{nbsphinx-code-border}{HTML}{E0E0E0}
\definecolor{nbsphinx-stderr}{HTML}{FFDDDD}
% ANSI colors for output streams and traceback highlighting
\definecolor{ansi-black}{HTML}{3E424D}
\definecolor{ansi-black-intense}{HTML}{282C36}
\definecolor{ansi-red}{HTML}{E75C58}
\definecolor{ansi-red-intense}{HTML}{B22B31}
\definecolor{ansi-green}{HTML}{00A250}
\definecolor{ansi-green-intense}{HTML}{007427}
\definecolor{ansi-yellow}{HTML}{DDB62B}
\definecolor{ansi-yellow-intense}{HTML}{B27D12}
\definecolor{ansi-blue}{HTML}{208FFB}
\definecolor{ansi-blue-intense}{HTML}{0065CA}
\definecolor{ansi-magenta}{HTML}{D160C4}
\definecolor{ansi-magenta-intense}{HTML}{A03196}
\definecolor{ansi-cyan}{HTML}{60C6C8}
\definecolor{ansi-cyan-intense}{HTML}{258F8F}
\definecolor{ansi-white}{HTML}{C5C1B4}
\definecolor{ansi-white-intense}{HTML}{A1A6B2}
\definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
\definecolor{ansi-default-inverse-bg}{HTML}{000000}

% Define an environment for non-plain-text code cell outputs (e.g. images)
\makeatletter
\newenvironment{nbsphinxfancyoutput}{%
    % Avoid fatal error with framed.sty if graphics too long to fit on one page
    \let\sphinxincludegraphics\nbsphinxincludegraphics
    \nbsphinx@image@maxheight\textheight
    \advance\nbsphinx@image@maxheight -2\fboxsep   % default \fboxsep 3pt
    \advance\nbsphinx@image@maxheight -2\fboxrule  % default \fboxrule 0.4pt
    \advance\nbsphinx@image@maxheight -\baselineskip
\def\nbsphinxfcolorbox{\spx@fcolorbox{nbsphinx-code-border}{white}}%
\def\FrameCommand{\nbsphinxfcolorbox\nbsphinxfancyaddprompt\@empty}%
\def\FirstFrameCommand{\nbsphinxfcolorbox\nbsphinxfancyaddprompt\sphinxVerbatim@Continues}%
\def\MidFrameCommand{\nbsphinxfcolorbox\sphinxVerbatim@Continued\sphinxVerbatim@Continues}%
\def\LastFrameCommand{\nbsphinxfcolorbox\sphinxVerbatim@Continued\@empty}%
\MakeFramed{\advance\hsize-\width\@totalleftmargin\z@\linewidth\hsize\@setminipage}%
}{\par\unskip\@minipagefalse\endMakeFramed}
\makeatother
\newbox\nbsphinxpromptbox
\def\nbsphinxfancyaddprompt{\ifvoid\nbsphinxpromptbox\else
    \kern\fboxrule\kern\fboxsep
    \copy\nbsphinxpromptbox
    \kern-\ht\nbsphinxpromptbox\kern-\dp\nbsphinxpromptbox
    \kern-\fboxsep\kern-\fboxrule\nointerlineskip
    \fi}
\newlength\nbsphinxcodecellspacing
\setlength{\nbsphinxcodecellspacing}{0pt}

% Define support macros for attaching opening and closing lines to notebooks
\newsavebox\nbsphinxbox
\makeatletter
\newcommand{\nbsphinxstartnotebook}[1]{%
    \par
    % measure needed space
    \setbox\nbsphinxbox\vtop{{#1\par}}
    % reserve some space at bottom of page, else start new page
    \needspace{\dimexpr2.5\baselineskip+\ht\nbsphinxbox+\dp\nbsphinxbox}
    % mimick vertical spacing from \section command
      \addpenalty\@secpenalty
      \@tempskipa 3.5ex \@plus 1ex \@minus .2ex\relax
      \addvspace\@tempskipa
      {\Large\@tempskipa\baselineskip
             \advance\@tempskipa-\prevdepth
             \advance\@tempskipa-\ht\nbsphinxbox
             \ifdim\@tempskipa>\z@
               \vskip \@tempskipa
             \fi}
    \unvbox\nbsphinxbox
    % if notebook starts with a \section, prevent it from adding extra space
    \@nobreaktrue\everypar{\@nobreakfalse\everypar{}}%
    % compensate the parskip which will get inserted by next paragraph
    \nobreak\vskip-\parskip
    % do not break here
    \nobreak
}% end of \nbsphinxstartnotebook

\newcommand{\nbsphinxstopnotebook}[1]{%
    \par
    % measure needed space
    \setbox\nbsphinxbox\vbox{{#1\par}}
    \nobreak % it updates page totals
    \dimen@\pagegoal
    \advance\dimen@-\pagetotal \advance\dimen@-\pagedepth
    \advance\dimen@-\ht\nbsphinxbox \advance\dimen@-\dp\nbsphinxbox
    \ifdim\dimen@<\z@
      % little space left
      \unvbox\nbsphinxbox
      \kern-.8\baselineskip
      \nobreak\vskip\z@\@plus1fil
      \penalty100
      \vskip\z@\@plus-1fil
      \kern.8\baselineskip
    \else
      \unvbox\nbsphinxbox
    \fi
}% end of \nbsphinxstopnotebook

% Ensure height of an included graphics fits in nbsphinxfancyoutput frame
\newdimen\nbsphinx@image@maxheight % set in nbsphinxfancyoutput environment
\newcommand*{\nbsphinxincludegraphics}[2][]{%
    \gdef\spx@includegraphics@options{#1}%
    \setbox\spx@image@box\hbox{\includegraphics[#1,draft]{#2}}%
    \in@false
    \ifdim \wd\spx@image@box>\linewidth
      \g@addto@macro\spx@includegraphics@options{,width=\linewidth}%
      \in@true
    \fi
    % no rotation, no need to worry about depth
    \ifdim \ht\spx@image@box>\nbsphinx@image@maxheight
      \g@addto@macro\spx@includegraphics@options{,height=\nbsphinx@image@maxheight}%
      \in@true
    \fi
    \ifin@
      \g@addto@macro\spx@includegraphics@options{,keepaspectratio}%
    \fi
    \setbox\spx@image@box\box\voidb@x % clear memory
    \expandafter\includegraphics\expandafter[\spx@includegraphics@options]{#2}%
}% end of "\MakeFrame"-safe variant of \sphinxincludegraphics
\makeatother



\title{predicode}
\date{Aug 24, 2019}
\release{0.0.0.9000}
\author{Samuel Lippl}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{Installation}
\label{\detokenize{usage/installation:Installation}}\label{\detokenize{usage/installation::doc}}
Install ‘predicode’ using pip and the command

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip install predicode
\end{sphinxVerbatim}

If you would like the newest development version, use pip to install the package from the \sphinxhref{github.com/sflippl/predicode}{GitHub} repository using the command

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip install git+https://github.com/sflippl/predicode
\end{sphinxVerbatim}


\chapter{Datasets}
\label{\detokenize{usage/datasets:Datasets}}\label{\detokenize{usage/datasets::doc}}
\sphinxhref{https://colab.research.google.com/github/sflippl/predicode/blob/master/usage/datasets.ipynb}{\sphinxincludegraphics{{/home/sflippl/Documents/predicode/predicode/docs/doctrees/images/b54294fd4278d22369403065806b2c772298d1fc/blue}.svg}}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k}{try}\PYG{p}{:}
    \PYG{k+kn}{import} \PYG{n+nn}{predicode} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k}{except}\PYG{p}{:}
    \PYG{o}{!}pip install git+https://github.com/sflippl/predicode
    \PYG{k+kn}{import} \PYG{n+nn}{predicode} \PYG{k}{as} \PYG{n+nn}{pc}
\end{sphinxVerbatim}
}



%
{
\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Using TensorFlow backend.
\end{sphinxVerbatim}
}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax


\section{Artificial Datasets}
\label{\detokenize{usage/datasets:Artificial-Datasets}}
Artificial datasets provide a simple example for how the algorithm works and an opportunity to study its analytical solutions.


\subsection{Decaying Multinormal Distribution}
\label{\detokenize{usage/datasets:Decaying-Multinormal-Distribution}}
The closed-form solution of a linear predictive coding model is given by a principal components analysis. A multinormal distribution allows for an easy model for such a solution. The class ‘DecayingMultiNormal’ models a high-dimensional input with decaying importance. Namely, the variance of the different principal components is specified using the decay constant ‘alpha’. Dimensionality of the input data is specified using ‘dimensions’ and sample size is specified by ‘samples’.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{art\PYGZus{}data} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{DecayingMultiNormal}\PYG{p}{(}\PYG{n}{dimensions} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{p}{,}
                                  \PYG{n}{samples} \PYG{o}{=} \PYG{l+m+mi}{10000}\PYG{p}{,}
                                  \PYG{n}{alpha} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{k+kn}{import} \PYG{n+nn}{lazytools}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{lazytools}\PYG{o}{.}\PYG{n}{matrix\PYGZus{}heatmap}\PYG{p}{(}\PYG{n}{art\PYGZus{}data}\PYG{o}{.}\PYG{n}{data}\PYG{p}{,} \PYG{n}{pole} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=611\sphinxpxdimen,height=396\sphinxpxdimen]{{usage_datasets_8_0}.png}

\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimColor={named}{white}}

\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZlt{}ggplot: (8735735730103)\PYGZgt{}
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{lazytools}\PYG{o}{.}\PYG{n}{matrix\PYGZus{}heatmap}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{cov}\PYG{p}{(}\PYG{n}{art\PYGZus{}data}\PYG{o}{.}\PYG{n}{data}\PYG{o}{.}\PYG{n}{T}\PYG{p}{)}\PYG{p}{,} \PYG{n}{pole} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=622\sphinxpxdimen,height=396\sphinxpxdimen]{{usage_datasets_9_0}.png}

\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimColor={named}{white}}

\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZlt{}ggplot: (8735682449065)\PYGZgt{}
\end{sphinxVerbatim}
}


\section{Image Datasets}
\label{\detokenize{usage/datasets:Image-Datasets}}
Image datasets are predominantly included as examples for the predictive coding algorithms under the ‘datasets’ module. Whereas their main purpose is being incorporated by the respective algorithms, ‘predicode’ allows for some functionality in exploring the datasets on their own. In particular, a number of images may be visualized using the pictures method (see Cifar-10 below).


\section{Cifar-10}
\label{\detokenize{usage/datasets:Cifar-10}}
Cifar-10 serves as a simple example dataset for basic predictive coding algorithms demonstrating static extraclassical effects.

For now, only the training dataset can be read in using the class \sphinxcode{\sphinxupquote{Cifar10}}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{predicode} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{n}{cifar} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{Cifar10}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

This dataset may be explored by looking at the pictures along with their labels. This is possible in black-white and color.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{cifar}\PYG{o}{.}\PYG{n}{pictures}\PYG{p}{(}\PYG{n}{subset} \PYG{o}{=} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{25}\PYG{p}{)}\PYG{p}{,} \PYG{n}{mode} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=523\sphinxpxdimen,height=669\sphinxpxdimen]{{usage_datasets_17_0}.png}

\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimColor={named}{white}}

\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZlt{}ggplot: (\PYGZhy{}9223363293114942036)\PYGZgt{}
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{cifar}\PYG{o}{.}\PYG{n}{pictures}\PYG{p}{(}\PYG{n}{subset} \PYG{o}{=} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{25}\PYG{p}{)}\PYG{p}{,} \PYG{n}{mode} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{color}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=523\sphinxpxdimen,height=669\sphinxpxdimen]{{usage_datasets_18_0}.png}

\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimColor={named}{white}}

\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZlt{}ggplot: (8743719730980)\PYGZgt{}
\end{sphinxVerbatim}
}

This builds upon the underlying data frame that contains the RGB values for the color and the black-white pictures:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{cifar}\PYG{o}{.}\PYG{n}{rgb\PYGZus{}dataframe}\PYG{p}{(}\PYG{n}{subset} \PYG{o}{=} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimColor={named}{white}}

\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}   image\PYGZus{}id  x  y   r   g   b         bw      rgb   rgb\PYGZus{}bw
0         0  0  0  59  62  63  61.333333  \PYGZsh{}3b3e3f  \PYGZsh{}3d3d3d
1         0  1  0  43  46  45  44.666667  \PYGZsh{}2b2e2d  \PYGZsh{}2c2c2c
2         0  2  0  50  48  43  47.000000  \PYGZsh{}32302b  \PYGZsh{}2f2f2f
3         0  3  0  68  54  42  54.666667  \PYGZsh{}44362a  \PYGZsh{}363636
4         0  4  0  98  73  52  74.333333  \PYGZsh{}624934  \PYGZsh{}4a4a4a
\end{sphinxVerbatim}
}


\chapter{Minimal Model}
\label{\detokenize{usage/minimal_model:Minimal-Model}}\label{\detokenize{usage/minimal_model::doc}}
\sphinxhref{https://colab.research.google.com/github/sflippl/predicode/blob/master/usage/minimal\_model.ipynb}{\sphinxincludegraphics{{/home/sflippl/Documents/predicode/predicode/docs/doctrees/images/1cbef8f858ac0e12d0cf2cb67076bcaff7e5a3c8/blue}.svg}}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[10]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k}{try}\PYG{p}{:}
    \PYG{k+kn}{import} \PYG{n+nn}{predicode} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k}{except}\PYG{p}{:}
    \PYG{o}{!}pip install git+https://github.com/sflippl/predicode
    \PYG{k+kn}{import} \PYG{n+nn}{predicode} \PYG{k}{as} \PYG{n+nn}{pc}
\end{sphinxVerbatim}
}

‘predicode’ contains several %
\begin{footnote}[1]\sphinxAtStartFootnote
so far one
%
\end{footnote} high-level interfaces to the more general hierarchical model %
\begin{footnote}[2]\sphinxAtStartFootnote
not yet a thing
%
\end{footnote}. We will use the minimal model, consisting of an input layer and one latent layer with a specified number of dimensions as an example. As an example, we will use an artificial dataset as presented in the previous chapter.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{art} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{DecayingMultiNormal}\PYG{p}{(}\PYG{n}{dimensions} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{p}{,}
                             \PYG{n}{samples} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{p}{)}
\end{sphinxVerbatim}
}

The minimal model can be fitted by providing input data and the number of latent dimensions to the class ‘pc.MinimalHierarchicalModel’:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{hpc} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{MinimalHierarchicalModel}\PYG{p}{(}\PYG{n}{input\PYGZus{}data} \PYG{o}{=} \PYG{n}{art}\PYG{o}{.}\PYG{n}{data}\PYG{p}{,}
                                  \PYG{n}{latent\PYGZus{}dimensions} \PYG{o}{=} \PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}
}



%
{
\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
WARNING: Logging before flag parsing goes to stderr.
W0824 15:59:17.338732 139821115447104 estimator.py:1811] Using temporary folder as model directory: /tmp/tmp8kmjnddb
\end{sphinxVerbatim}
}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax


\section{State Estimation}
\label{\detokenize{usage/minimal_model:State-Estimation}}
By default the weights of the minimal model are initialized as the first PCA components. This is the optimal solution for the minimal model and can be used to study state estimation. Since a predictive coding model can improve either by adapting its states or its weights, we first need to specify which of the two can currently be modified:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[5]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{hpc}\PYG{o}{.}\PYG{n}{activate}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{state}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

(Technically, this would not have been necessary.) States are activated by default.

The minimal model can then be trained in order to extract the latent values.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[6]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{hpc}\PYG{o}{.}\PYG{n}{train}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}



%
{
\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
W0824 15:59:18.510554 139821115447104 deprecation.py:323] From /home/sflippl/.local/lib/python3.7/site-packages/tensorflow/python/training/training\_util.py:236: Variable.initialized\_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read\_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
W0824 15:59:18.523109 139821115447104 deprecation\_wrapper.py:119] From /home/sflippl/.local/lib/python3.7/site-packages/predicode/hierarchical/interfaces/minimal\_model.py:24: The name tf.feature\_column.input\_layer is deprecated. Please use tf.compat.v1.feature\_column.input\_layer instead.

W0824 15:59:18.524461 139821115447104 deprecation.py:323] From /home/sflippl/.local/lib/python3.7/site-packages/tensorflow/python/feature\_column/feature\_column.py:205: NumericColumn.\_get\_dense\_tensor (from tensorflow.python.feature\_column.feature\_column\_v2) is deprecated and will be removed in a future version.
Instructions for updating:
The old \_FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.
W0824 15:59:18.525506 139821115447104 deprecation.py:323] From /home/sflippl/.local/lib/python3.7/site-packages/tensorflow/python/feature\_column/feature\_column.py:2115: NumericColumn.\_transform\_feature (from tensorflow.python.feature\_column.feature\_column\_v2) is deprecated and will be removed in a future version.
Instructions for updating:
The old \_FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.
W0824 15:59:18.532030 139821115447104 deprecation.py:323] From /home/sflippl/.local/lib/python3.7/site-packages/tensorflow/python/feature\_column/feature\_column.py:206: NumericColumn.\_variable\_shape (from tensorflow.python.feature\_column.feature\_column\_v2) is deprecated and will be removed in a future version.
Instructions for updating:
The old \_FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.
W0824 15:59:18.574176 139821115447104 deprecation.py:323] From /home/sflippl/.local/lib/python3.7/site-packages/predicode/hierarchical/interfaces/minimal\_model.py:27: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0824 15:59:18.576800 139821115447104 deprecation.py:506] From /home/sflippl/.local/lib/python3.7/site-packages/tensorflow/python/ops/init\_ops.py:1251: calling VarianceScaling.\_\_init\_\_ (from tensorflow.python.ops.init\_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
W0824 15:59:18.836281 139821115447104 deprecation\_wrapper.py:119] From /home/sflippl/.local/lib/python3.7/site-packages/predicode/hierarchical/interfaces/minimal\_model.py:10: The name tf.losses.mean\_squared\_error is deprecated. Please use tf.compat.v1.losses.mean\_squared\_error instead.

W0824 15:59:18.848142 139821115447104 deprecation.py:323] From /home/sflippl/.local/lib/python3.7/site-packages/tensorflow/python/ops/losses/losses\_impl.py:121: add\_dispatch\_support.<locals>.wrapper (from tensorflow.python.ops.array\_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0824 15:59:18.858359 139821115447104 deprecation\_wrapper.py:119] From /home/sflippl/.local/lib/python3.7/site-packages/predicode/hierarchical/interfaces/minimal\_model.py:19: The name tf.train.GradientDescentOptimizer is deprecated. Please use tf.compat.v1.train.GradientDescentOptimizer instead.

W0824 15:59:18.859064 139821115447104 deprecation\_wrapper.py:119] From /home/sflippl/.local/lib/python3.7/site-packages/predicode/hierarchical/interfaces/minimal\_model.py:20: The name tf.train.get\_global\_step is deprecated. Please use tf.compat.v1.train.get\_global\_step instead.

W0824 15:59:19.296718 139821115447104 basic\_session\_run\_hooks.py:724] It seems that global step (tf.train.get\_global\_step) has not been increased. Current value (could be stable): 6 vs previous value: 6. You could increase the global step by passing tf.train.get\_global\_step() to Optimizer.apply\_gradients or Optimizer.minimize.
W0824 15:59:19.312877 139821115447104 basic\_session\_run\_hooks.py:724] It seems that global step (tf.train.get\_global\_step) has not been increased. Current value (could be stable): 27 vs previous value: 27. You could increase the global step by passing tf.train.get\_global\_step() to Optimizer.apply\_gradients or Optimizer.minimize.
W0824 15:59:19.332931 139821115447104 basic\_session\_run\_hooks.py:724] It seems that global step (tf.train.get\_global\_step) has not been increased. Current value (could be stable): 62 vs previous value: 62. You could increase the global step by passing tf.train.get\_global\_step() to Optimizer.apply\_gradients or Optimizer.minimize.
W0824 15:59:19.340380 139821115447104 basic\_session\_run\_hooks.py:724] It seems that global step (tf.train.get\_global\_step) has not been increased. Current value (could be stable): 74 vs previous value: 74. You could increase the global step by passing tf.train.get\_global\_step() to Optimizer.apply\_gradients or Optimizer.minimize.
W0824 15:59:19.349026 139821115447104 basic\_session\_run\_hooks.py:724] It seems that global step (tf.train.get\_global\_step) has not been increased. Current value (could be stable): 86 vs previous value: 86. You could increase the global step by passing tf.train.get\_global\_step() to Optimizer.apply\_gradients or Optimizer.minimize.
\end{sphinxVerbatim}
}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimColor={named}{white}}

\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[6]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZlt{}tensorflow\PYGZus{}estimator.python.estimator.estimator.Estimator at 0x7f2a56b03b38\PYGZgt{}
\end{sphinxVerbatim}
}

The usual Tensorflow framework can be used in this context:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[7]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{hpc}\PYG{o}{.}\PYG{n}{evaluate}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}



%
{
\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
W0824 15:59:23.045202 139821115447104 deprecation.py:323] From /home/sflippl/.local/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1276: checkpoint\_exists (from tensorflow.python.training.checkpoint\_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
\end{sphinxVerbatim}
}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimColor={named}{white}}

\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[7]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZob{}\PYGZsq{}loss\PYGZsq{}: 3.4082903e\PYGZhy{}05, \PYGZsq{}global\PYGZus{}step\PYGZsq{}: 10000\PYGZcb{}
\end{sphinxVerbatim}
}

The method ‘latent\_values’ allows for the extraction of the latent values, which we here visualize using a heatmap:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[8]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{latent\PYGZus{}values} \PYG{o}{=} \PYG{n}{hpc}\PYG{o}{.}\PYG{n}{latent\PYGZus{}values}\PYG{p}{(}\PYG{p}{)}
\PYG{k+kn}{import} \PYG{n+nn}{lazytools}
\PYG{n}{lazytools}\PYG{o}{.}\PYG{n}{matrix\PYGZus{}heatmap}\PYG{p}{(}\PYG{n}{latent\PYGZus{}values}\PYG{p}{,} \PYG{n}{pole} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=611\sphinxpxdimen,height=396\sphinxpxdimen]{{usage_minimal_model_16_0}.png}

\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimColor={named}{white}}

\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[8]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZlt{}ggplot: (8738711660976)\PYGZgt{}
\end{sphinxVerbatim}
}

Similarly the predictions generated by the latent values can be studied:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[9]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{predictions} \PYG{o}{=} \PYG{n}{hpc}\PYG{o}{.}\PYG{n}{predict}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{lazytools}\PYG{o}{.}\PYG{n}{matrix\PYGZus{}heatmap}\PYG{p}{(}\PYG{n}{predictions}\PYG{p}{,} \PYG{n}{pole} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}
}



%
{
\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
W0824 15:59:23.500001 139821115447104 estimator.py:1000] Input graph does not use tf.data.Dataset or contain a QueueRunner. That means predict yields forever. This is probably a mistake.
\end{sphinxVerbatim}
}
% The following \relax is needed to avoid problems with adjacent ANSI
% cells and some other stuff (e.g. bullet lists) following ANSI cells.
% See https://github.com/sphinx-doc/sphinx/issues/3594
\relax

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics[width=623\sphinxpxdimen,height=396\sphinxpxdimen]{{usage_minimal_model_18_1}.png}

\end{nbsphinxfancyoutput}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}
\sphinxsetup{VerbatimColor={named}{white}}

\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[9]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZlt{}ggplot: (8738711440090)\PYGZgt{}
\end{sphinxVerbatim}
}


\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{Index}
\printindex
\end{document}